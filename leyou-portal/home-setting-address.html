<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE">
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/>
    <title>设置-个人信息</title>
    <link rel="icon" href="assets/img/favicon.ico">

    <link rel="stylesheet" type="text/css" href="css/webbase.css"/>
    <link rel="stylesheet" type="text/css" href="css/pages-seckillOrder.css"/>
</head>

<body>
<!--页面顶部白条条，由js动态加载-->
<script type="text/javascript" src="plugins/jquery/jquery.min.js"></script>
<div class="nav-bottom"></div>
<!--<script type="text/javascript">$(".nav-bottom").load("top.html");</script>-->
<script type="text/javascript">$(".nav-bottom").load("top.html");</script>
<script type="text/javascript" src="js/plugins/jquery/jquery.min.js"></script>
<script type="text/javascript">
    $(function () {
        $("#service").hover(function () {
            $(".service").show();
        }, function () {
            $(".service").hide();
        });
        $("#shopcar").hover(function () {
            $("#shopcarlist").show();
        }, function () {
            $("#shopcarlist").hide();
        });

    })
</script>
<script type="text/javascript" src="js/plugins/jquery.easing/jquery.easing.min.js"></script>
<script type="text/javascript" src="js/plugins/sui/sui.min.js"></script>
<script type="text/javascript" src="js/plugins/jquery-placeholder/jquery.placeholder.min.js"></script>
<script type="text/javascript" src="js/widget/nav.js"></script>
<!--<script type="text/javascript" src="pages/userInfo/distpicker.data.js"></script>-->
<!--<script type="text/javascript" src="pages/userInfo/distpicker.js"></script>-->
<!--<script type="text/javascript" src="pages/userInfo/main.js"></script>-->


</body>
<!--header-->
<div id="addressApp">
    <div id="account">
        <div class="py-container">
            <div class="yui3-g home">
                <!--左侧列表-->
                <div class="yui3-u-1-6 list">

                    <div class="person-info">
                        <div class="person-photo"><img src="img/_/photo.png" alt=""></div>
                        <div class="person-account">
                            <span class="name">{{user.username}}</span>
                            <span class="safe">账户安全</span>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <div class="list-items">
                        <dl>
                            <dt><i>·</i> 订单中心</dt>
                            <dd><a href="home-index.html">我的订单</a></dd>
                        </dl>
                        <dl>
                            <dt><i>·</i> 设置</dt>
                            <dd><a href="home-setting-address.html" class="list-active">地址管理</a></dd>
                            <dd><a href="home-setting-safe.html">安全管理</a></dd>
                        </dl>
                    </div>
                </div>
                <!--右侧主内容-->
                <div class="yui3-u-5-6">
                    <div class="body userAddress">
                        <div class="address-title">
                            <span class="title">地址管理</span>
                            <a data-toggle="modal" data-target=".edit" data-keyboard="false"
                               class="sui-btn  btn-info add-new">添加新地址</a>
                            <span class="clearfix"></span>
                        </div>
                        <div class="address-detail">
                            <table class="sui-table table-bordered">
                                <thead>
                                <tr>
                                    <th>姓名</th>
                                    <th>地址</th>
                                    <th>联系电话</th>
                                    <th>操作</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr v-for="(address,index) in addresss" :key="index">
                                    <td>{{address.buyerNick}}</td>
                                    <td>{{address.receiverState}} {{address.buyerNick}} {{address.receiverDistrict}}
                                        {{address.receiverAddress}}
                                    </td>
                                    <td>{{address.receiverMobile}}</td>
                                    <td>
                                        <a href="#">编辑</a>
                                        <a href="#">删除</a>
                                        默认地址
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <!--新增地址弹出层-->
                        <div tabindex="-1" role="dialog" data-hasfoot="false" class="sui-modal hide fade edit"
                             style="width:580px;">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" data-dismiss="modal" aria-hidden="true" class="sui-close">
                                            ×
                                        </button>
                                        <h4 id="myModalLabel" class="modal-title">新增地址</h4>
                                    </div>
                                    <div class="modal-body">
                                        <form class="sui-form">
                                            <div class="control-group">
                                                <label class="control-label">收货人：</label>
                                                <div class="controls">
                                                    <input type="text" id="buyerNick" class="input-medium" v-model="form.buyerNick">

                                                </div>
                                            </div>
                                            <div class="control-group">
                                                <label class="control-label">所在地区：</label>
                                                <div class="controls">
                                                    <div data-toggle="distpicker">
                                                        <div class="form-group area">
                                                            <input type="text" id="receiverState" class="input-medium" v-model="form.receiverState">
                                                        </div>
                                                        <div class="form-group area">
                                                            <input type="text" id="receiverCity" class="input-medium" v-model="form.receiverCity">
                                                        </div>
                                                        <div class="form-group area">
                                                            <input type="text" id="receiverDistrict" class="input-medium" v-model="form.receiverDistrict">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="control-group">
                                                <label class="control-label">详细地址：</label>
                                                <div class="controls">
                                                    <input type="text" id="receiverAddress" class="input-large" v-model="form.receiverAddress">
                                                </div>
                                            </div>
                                            <div class="control-group">
                                                <label class="control-label">联系电话：</label>
                                                <div class="controls">
                                                    <input type="text" id="receiverMobile" class="input-medium" v-model="form.receiverMobile">
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" data-ok="modal" class="sui-btn btn-primary btn-large"
                                                        @click="addAddress">确定
                                                </button>
                                                <button type="button" data-dismiss="modal"
                                                        class="sui-btn btn-default btn-large">取消
                                                </button>
                                            </div>
                                        </form>

                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="./js/vue/vue.js"></script>
<script src="./js/axios.min.js"></script>
<script src="./js/common.js"></script>
<script type="text/javascript">
    var addressApp = new Vue({
        el: "#addressApp",
        data: {
            ly,
            page: 1,
            user: null,
            addresss: [], // 当前页品牌数据
            form:{
                buyerNick:'',
                receiverAddress:'',
                receiverCity:'',
                receiverDistrict:'',
                receiverMobile:'',
                receiverState:''
            },
        },

        created() {
            ly.verify().then(res => {
                this.user = res.data;
                this.loadData();
            }).catch(() => {
                //未登录购物车的查询
                //window.location = "http://www.leyou.com/login.html?returnUrl=http://www.leyou.com/cart.html";
            })
        },

        methods: {
            loadData() {
                ly.verify().then(res => {
                    ly.http.get("/order/order/getAddress"
                    ).then(({data}) => { // 这里使用箭头函数
                        this.addresss = data;
                    });
                })
            },
            goSku(skuId) {
                var url = "http://api.leyou.com/api";
                ly.http.get(url + "/item/sku/" + skuId
                ).then(({data}) => { // 这里使用箭头函数
                    window.location = "http://www.leyou.com/item/" + data.spuId + ".html";
                });
            },
            addAddress() {
                ly.verify().then(res => {
                    ly.http.post("/order/order/addAddress", this.form)
                        .then(resp => {
                            this.loadData();
                        }).catch(() => this.msg = '添加失败');
                })
            }
        },
    });
</script>

<!-- 底部栏位 -->
<!--页面底部，由js动态加载-->
<div class="clearfix footer"></div>
<script type="text/javascript" src="js/plugins/jquery/jquery.min.js"></script>
<script type="text/javascript">$(".footer").load("foot.html");</script>
<!--页面底部END-->

<script type="text/javascript" src="js/plugins/jquery.easing/jquery.easing.min.js"></script>
<script type="text/javascript" src="js/plugins/sui/sui.min.js"></script>


</html>